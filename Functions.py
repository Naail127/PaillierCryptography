import math
import random
import os

p = int(os.getenv("p1"))
q = int(os.getenv("p2"))

n = p * q
phi = (p - 1) * (q - 1)
g = 1 + n
lamda = phi * 1
mu = pow(phi, -1, n)

def is_prime(x):
    for i in range(2, x):
        if x % i == 0:
            return False
    return True
def get_coprime(y):
    r = random.randint(0, n)
    while math.gcd(r, y) != 1:
        r = random.randint(0, n)
    return r

def lx(x):
    y = (x-1)//n
    assert y % 1 == 0
    return y

def encrypt(m):
    r = get_coprime(n)
    c = pow(g, m, n * n) * pow(r, n, n * n) % (n * n)
    return c

def decrypt(c):
    p = ((lx(pow(c, lamda, n*n)) *mu) % n)
    return p

def encrypt_message(message):
    message = encrypt(message)
    return(message)



user = "jgdjfkdfngfnghjkfgjhjfghfghrtjjkrgjkfjghklfkljghfklghklfghlkfglkhfgklhfglkh"
passw = "jghjkfgdjwiejiwefksdndnbmnmbdjbndfdfg"

username = ''.join(format(b, '08b') for b in user.encode())
password = ''.join(format(b, '08b') for b in passw.encode())

e1 = 1630323488026841418030697544512284220250056861920333104921580184519171886315584298952206335193427947920517015557394138361401662268606758260968264928766061146715501782259730102587386992480590854947584870597385946419457738547016285939979379247719050380554934273845263149109367727063995416259583406339293513784450032236112710779483135005146868497943497990509847131354623304036498724062647929117069018190456699190135189949170827349431923936472799385154209474355371619095459217079445284534687294751811747739342406478688021510113570230310589343438858059221802172450126173854228145803631066024515752574552194362518291798318654972820809054537825677405376703563358921458999079803139068912021263281252260051151464111331870797160654361565585062334842711590273682155311224080025790562346706225157840691740152119107657412173022549568972781822832059162151890138780162750823685534664571744727928875119660341548966492609635873851736159604603116160281663807110463658490035273601925186966944661839796724820075745002836520341510962995657915946775345064777936701898167677872102193582093634193461522127447511537939317303320899867356246159523205170576898868097570028947090684893636830512764506364084201041574640952089421
e2 = 7896576577091282666317275827122501745618028563440966804873554597686593466187497741864305472282395996622659223545127093501636698061595401555317678429750195440018710298760734957404481573439773904482806930650609762339903547936015204362311027753059216046627282018278278885533572944139750728373995268895652264209337299426614493199993938049195667023236630978987641360914093541764180616995924679984074996624398008815194290485608122802255818441642484090269368387408237034623247738112112036280655669430071621270379055868222000638615723876961989676395407769852148117537335087314813872978439854729795524697743765908088797877315487968997375752558048684486416318566223638721439992087879283115497500989946334309029391228749264947490377214013472640952090665001237206737031983241518833948860575867520707776494737469940248955716782071192221736696881328938994009343876873862718913459038853426482276513587253037287773406626112330165515753147486478150827341214510126718946836032432361459036025143477438476906082360030687010285224577101307886962845358680103076887422668634115788019568200152954867872685667352296443864298225792927514307691604100611633001784050363633352937170463322576068467949176323923655218704031942212
chunk_size = 8
decrypted_user_binary = format(decrypt(e1), 'b')
while len(decrypted_user_binary) % 8 != 0:
    decrypted_user_binary = '0' + decrypted_user_binary

string_chunk = [decrypted_user_binary[i:i + chunk_size] for i in range(0, len(decrypted_user_binary), chunk_size)]
username = ''.join([chr(int(chunk, 2)) for chunk in string_chunk])

decrypted_pass_binary = format(decrypt(e2), 'b')
while len(decrypted_pass_binary) % 8 != 0:
    decrypted_pass_binary = '0' + decrypted_pass_binary

string_chunks = [decrypted_pass_binary[i:i + chunk_size] for i in range(0, len(decrypted_pass_binary), chunk_size)]
password = ''.join([chr(int(chunk, 2)) for chunk in string_chunks])
print(decrypt(e1), username)
print(decrypt(e2), password)


